import{ad as vs,ae as ks,af as Ns,ag as ws,ah as Cs,ai as Ps,aj as Ds,ak as Ss,al as Rs,j as e,F as Ye,D as Ms,f as Fs,g as Ls,h as Ts,B as ze,am as Ze,v as Es,a1 as Us,X as As,Y as qs,Z as Is,an as se,ao as ae,V as O,ap as te,aq as N,N as zs,O as $s,P as Ws,R as Js,a3 as Os,a8 as Gs,a9 as Bs,aa as Pe,ab as De,C as Se,a as Re,b as Me,d as Fe,n as Qs,p as Hs,q as $e,r as Ks,W as Xe,s as Vs,t as _e,U as Ys,m as We,a2 as es,ar as ss,a4 as Zs,i as Xs,as as _s,a5 as ea,at as sa}from"./index-_oGFPpUs.js";import{r as l,g as aa,d as ta,L as as}from"./router-DHx2Xk7F.js";import{c as $,h as q,j as Le,q as me,f as H,w as I,A as ts,l as ra,k as Te,t as fe,v as K,y as rs,z as na,F as la}from"./firebase-C4-V31L8.js";import{C as ns}from"./modal-LW_Ro6Aa.js";import{F as ia,L as u,C as ue}from"./label-BPzL8Ay2.js";import{F as oa,a as da}from"./TrashIcon-CsJ-wBAl.js";import"./vendor-DJG_os-6.js";let ca="input";function ma(i,y){let L=l.useId(),T=ks(),S=Ns(),{id:x=T||`headlessui-input-${L}`,disabled:g=S||!1,autoFocus:c=!1,invalid:k=!1,...re}=i,w=ws(),D=Cs(),{isFocused:m,focusProps:ne}=Ps({autoFocus:c}),{isHovered:V,hoverProps:le}=Ds({isDisabled:g}),E=Ss({ref:y,id:x,"aria-labelledby":w,"aria-describedby":D,"aria-invalid":k?"true":void 0,disabled:g||void 0,autoFocus:c},ne,le),he=l.useMemo(()=>({disabled:g,invalid:k,hover:V,focus:m,autofocus:c}),[g,k,V,m,c]);return Rs()({ourProps:E,theirProps:re,slot:he,defaultTag:ca,name:"Input"})}let ua=vs(ma);const ha=({currentImageUrl:i,onImageSelect:y,onImageRemove:L,onImageUpload:T,uploading:S=!1,error:x,className:g="",size:c="lg",title:k="Image",placeholder:re="Upload",acceptedFormats:w=["JPG","PNG","GIF","WebP"],maxSizeInMB:D=5,disabled:m=!1})=>{const[ne,V]=l.useState(!1),[le,E]=l.useState(!1),[he,Ee]=l.useState(!1),[pe,W]=l.useState(null),Y=l.useRef(null),G=S||he,B=x||pe,Z={sm:{container:"w-16 h-16",icon:"h-4 w-4",button:"p-1",text:"text-xs"},md:{container:"w-20 h-20",icon:"h-5 w-5",button:"p-1.5",text:"text-sm"},lg:{container:"w-24 h-24",icon:"h-6 w-6",button:"p-2",text:"text-base"}}[c],ie=g.includes("w-")?"":Z.container,oe=l.useCallback(b=>{if(!b.type.startsWith("image/"))return`Please select an image file (${w.join(", ")})`;const U=D*1024*1024;return b.size>U?`Image size must be less than ${D}MB`:null},[w,D]),C=l.useCallback(async b=>{if(m)return;const U=oe(b);if(U){W(U);return}if(W(null),T){Ee(!0);try{await T(b),E(!1)}catch(ke){const ge=ke instanceof Error?ke.message:"Failed to upload image";W(ge)}finally{Ee(!1)}}else y&&y(b),E(!1);Y.current&&(Y.current.value="")},[m,oe,T,y]),je=l.useCallback(b=>{const U=b.target.files?.[0];U&&C(U)},[C]),de=l.useCallback(b=>{m||(b.preventDefault(),V(!0))},[m]),ye=l.useCallback(b=>{b.preventDefault(),V(!1)},[]),Ue=l.useCallback(b=>{if(m)return;b.preventDefault(),V(!1);const U=b.dataTransfer.files;U.length>0&&C(U[0])},[m,C]),ve=l.useCallback(()=>{m||(L?L():y&&y(null),W(null),E(!1))},[m,L,y]),X=l.useCallback(()=>{m||Y.current?.click()},[m]),xe=l.useCallback(()=>{m||(i?E(!0):X())},[m,i,X]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`space-y-3 ${g}`,children:[e.jsxs("div",{className:`
            relative ${ie} rounded-lg overflow-hidden border-2 border-dashed 
            transition-all duration-200 cursor-pointer flex-shrink-0 ${g}
            ${ne?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-zinc-600 hover:border-gray-400 dark:hover:border-zinc-500"}
            ${G||m?"pointer-events-none opacity-75":""}
            ${B?"border-red-500 bg-red-50 dark:bg-red-900/20":""}
          `,onDragOver:de,onDragLeave:ye,onDrop:Ue,onClick:xe,children:[i?e.jsx("img",{src:i,alt:k,className:"w-full h-full object-cover"}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full bg-gradient-to-br from-gray-100 to-gray-200 dark:from-zinc-700 dark:to-zinc-800 text-gray-600 dark:text-zinc-400",children:[e.jsx(ia,{className:`${Z.icon} mb-1`}),e.jsxs("div",{className:`${Z.text} text-center`,children:[e.jsx("p",{className:"font-medium",children:k}),e.jsx("p",{className:"text-xs opacity-75",children:re})]})]}),G&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-white"})})]}),e.jsx("input",{ref:Y,type:"file",accept:"image/*",onChange:je,className:"hidden",disabled:G||m}),B&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 text-red-700 text-sm rounded-md dark:bg-red-900/20 dark:border-red-800 dark:text-red-300",children:[e.jsx(Ye,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Upload Error"}),e.jsx("p",{className:"text-xs mt-1 opacity-90",children:B})]})]})]}),e.jsxs(Ms,{open:le,onClose:()=>E(!1),size:"lg",children:[e.jsx(Fs,{children:k}),e.jsxs(Ls,{children:[i&&e.jsx("div",{className:"mb-6",children:e.jsx("img",{src:i,alt:k,className:"w-full h-auto max-h-96 object-contain rounded-lg"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsxs("p",{children:["• Supported formats: ",w.join(", ")]}),e.jsxs("p",{children:["• Maximum size: ",D,"MB"]}),e.jsx("p",{children:"• Drag & drop or click to upload"})]}),B&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 text-red-700 text-sm rounded-md dark:bg-red-900/20 dark:border-red-800 dark:text-red-300",children:[e.jsx(Ye,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Upload Error"}),e.jsx("p",{className:"text-xs mt-1 opacity-90",children:B})]})]})]})]}),e.jsxs(Ts,{children:[e.jsx(ze,{outline:!0,onClick:()=>E(!1),disabled:G,children:"Cancel"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ze,{onClick:X,disabled:G,color:"blue",children:[e.jsx(oa,{className:"h-4 w-4 mr-2"}),i?"Change Image":"Upload Image"]}),i&&e.jsxs(ze,{onClick:ve,disabled:G,color:"red",children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Remove Image"]})]})]})]})]})},xa=["date","datetime-local","month","time","week"],ga=l.forwardRef(function({className:y,...L},T){return e.jsx("span",{"data-slot":"control",className:Ze([y,"relative block w-full","before:absolute before:inset-px before:rounded-[calc(var(--radius-lg)-1px)] before:bg-white before:shadow-sm","dark:before:hidden","after:pointer-events-none after:absolute after:inset-0 after:rounded-lg after:ring-transparent after:ring-inset sm:focus-within:after:ring-2 sm:focus-within:after:ring-blue-500","has-data-disabled:opacity-50 has-data-disabled:before:bg-zinc-950/5 has-data-disabled:before:shadow-none","has-data-invalid:before:shadow-red-500/10"]),children:e.jsx(ua,{ref:T,...L,className:Ze([L.type&&xa.includes(L.type)&&["[&::-webkit-datetime-edit-fields-wrapper]:p-0","[&::-webkit-date-and-time-value]:min-h-[1.5em]","[&::-webkit-datetime-edit]:inline-flex","[&::-webkit-datetime-edit]:p-0","[&::-webkit-datetime-edit-year-field]:p-0","[&::-webkit-datetime-edit-month-field]:p-0","[&::-webkit-datetime-edit-day-field]:p-0","[&::-webkit-datetime-edit-hour-field]:p-0","[&::-webkit-datetime-edit-minute-field]:p-0","[&::-webkit-datetime-edit-second-field]:p-0","[&::-webkit-datetime-edit-millisecond-field]:p-0","[&::-webkit-datetime-edit-meridiem-field]:p-0"],"relative block w-full appearance-none rounded-lg px-[calc(--spacing(3.5)-1px)] py-[calc(--spacing(2.5)-1px)] sm:px-[calc(--spacing(3)-1px)] sm:py-[calc(--spacing(1.5)-1px)]","text-base/6 text-zinc-950 placeholder:text-zinc-500 sm:text-sm/6 dark:text-white","border border-zinc-950/10 data-hover:border-zinc-950/20 dark:border-white/10 dark:data-hover:border-white/20","bg-transparent dark:bg-white/5","focus:outline-hidden","data-invalid:border-red-500 data-invalid:data-hover:border-red-500 dark:data-invalid:border-red-500 dark:data-invalid:data-hover:border-red-500","data-disabled:border-zinc-950/20 dark:data-disabled:border-white/15 dark:data-disabled:bg-white/2.5 dark:data-hover:data-disabled:border-white/15","dark:scheme-dark"])})})}),Na=()=>{const{id:i}=aa(),y=ta(),[L,T]=l.useState(!0),[S,x]=l.useState(!1),[g,c]=l.useState(null),[k,re]=l.useState(null),[w,D]=l.useState([]),[m,ne]=l.useState([]),[V,le]=l.useState([]),[E,he]=l.useState([]),[Ee,pe]=l.useState(null),[W,Y]=l.useState(""),[G,B]=l.useState(!1),[Je,Z]=l.useState(!1),[ie,oe]=l.useState(null),[C,je]=l.useState({}),[de,ye]=l.useState({}),[Ue,ve]=l.useState(!1),[X,xe]=l.useState(null),[b,U]=l.useState(!1),[ke,ge]=l.useState(null),{isOpen:ls,selectedUser:is,openModal:os,closeModal:ds}=Es(),[cs,ms]=l.useState([]),[us,hs]=l.useState([]),[Oe,Ge]=l.useState(""),{config:ce,loading:Ne}=Us(),[t,h]=l.useState({name:"",description:"",status:"",isPublic:!0,gameMode:"",pointsToWin:150,maxPlayers:16,allowJoinRequests:!0,requireConfirmation:!0,ruleset:"standard",tournamentFormat:"round-robin",numberOfRounds:5,playoffsEnabled:!0,playoffTeams:4,pointsPerWin:3,pointsPerDraw:1,pointsPerLoss:0,usePointDifferential:!0,timeLimit:30,penaltiesEnabled:!0}),Be=async(s,a)=>{if(i){x(!0),c(null);try{const r=$(),o=q(r,"leagueJoinRequests",s);if(await fe(o,{status:a,updatedAt:K()}),a==="approved"){const d=m.find(n=>n.id===s);d&&(await la(r,async n=>{const z=me(H(r,"leagueMemberships"),I("leagueId","==",i),I("userId","==",d.userId)),R=await Te(z);if(R.empty){const P=q(H(r,"leagueMemberships"));n.set(P,{leagueId:i,userId:d.userId,joinedAt:K(),status:"active",role:"player",stats:{gamesPlayed:0,gamesWon:0,totalPoints:0,winRate:0,currentStreak:0,longestWinStreak:0}})}else{console.warn("Membership already exists for user",d.userId);const P=R.docs[0];n.update(P.ref,{status:"active",updatedAt:K()})}}),await js(i))}ne(d=>d.filter(n=>n.id!==s))}catch(r){console.error("Error handling join request:",r),c("Failed to process join request")}finally{x(!1)}}},xs=async()=>{if(i){x(!0),c(null);try{await _s(i),y("/leagues")}catch(s){console.error("Error deleting league:",s),c("Failed to delete league completely. Please try again."),x(!1)}}};l.useEffect(()=>{(async()=>{if(!i||!We.currentUser){y("/leagues");return}const a=$(),r=q(a,"leagues",i),o=await Le(r);if(!o.exists()){y("/leagues");return}const d={id:o.id,...o.data()};if(!es(We.currentUser)&&d.createdBy!==We.currentUser.uid){y(`/leagues/${i}`);return}})()},[i,y]),l.useEffect(()=>{const s=async()=>{if(i){T(!0),c(null);try{const r=$(),o=q(r,"leagues",i),d=await Le(o);if(!d.exists()){c("League not found"),T(!1);return}const n={id:d.id,...d.data()};re(n),h({name:n.name||"",description:n.description||"",status:n.status||"upcoming",isPublic:n.isPublic??!0,gameMode:n.settings?.gameMode??"double",pointsToWin:n.settings?.pointsToWin??150,maxPlayers:n.settings?.maxPlayers??16,allowJoinRequests:n.settings?.allowJoinRequests??!0,requireConfirmation:n.settings?.requireConfirmation??!0,ruleset:"standard",tournamentFormat:n.settings?.tournamentFormat??"round-robin",numberOfRounds:n.settings?.numberOfRounds??5,playoffsEnabled:n.settings?.playoffsEnabled??!0,playoffTeams:n.settings?.playoffTeams??4,pointsPerWin:n.settings?.scoringSystem?.pointsPerWin??3,pointsPerDraw:n.settings?.scoringSystem?.pointsPerDraw??1,pointsPerLoss:n.settings?.scoringSystem?.pointsPerLoss??0,usePointDifferential:n.settings?.scoringSystem?.usePointDifferential??!0,timeLimit:n.settings?.timeLimit??30,penaltiesEnabled:n.settings?.penaltiesEnabled??!0}),xe(n.photoURL||null);const z=me(H(r,"leagueMemberships"),I("leagueId","==",i),I("status","in",["active","inactive"])),R=ts(z,async F=>{const J=[],Q=[];F.forEach(f=>{const p={id:f.id,...f.data()};J.push(p),Q.push(p.userId)});const Ie=Q.map(async f=>{try{const p=await Le(q(r,"users",f));if(p.exists()){const v=p.data();return{userId:f,userData:v,isJudgeUser:es(v.email||""),displayName:v.displayName||v.username||f,photoURL:v.photoURL||null}}}catch(p){console.error(`Error fetching user data for ${f}:`,p)}return{userId:f,userData:null,isJudgeUser:!1,displayName:f,photoURL:null}});try{const f=await Promise.all(Ie),p=new Map(f.map(j=>[j.userId,j])),v=[],be=new Set;J.forEach(j=>{const ee=p.get(j.userId);ee&&!ee.isJudgeUser&&!be.has(j.userId)&&(v.push(j),be.add(j.userId))}),D(v);const A={...C},Ce={...de};f.forEach(j=>{j.isJudgeUser||(A[j.userId]=j.displayName,j.photoURL&&(Ce[j.userId]=j.photoURL))}),je(A),ye(Ce)}catch(f){console.error("Error processing member data:",f),D(J)}}),P=me(H(r,"leagueJoinRequests"),I("leagueId","==",i),I("status","==","pending")),M=ts(P,async F=>{const J=[],Q=[];F.forEach(p=>{const v={id:p.id,...p.data()};J.push(v),Q.push(v.userId)}),ne(J);const Ie={...C},f=Q.filter(p=>!Ie[p]);if(f.length>0&&!Ue){ve(!0);try{const p=[],v={...C},be={...de};f.forEach(A=>{const Ce=Le(q(r,"users",A)).then(j=>{if(j.exists()){const ee=j.data();v[A]=ee.displayName||ee.username||A,ee.photoURL&&(be[A]=ee.photoURL)}else v[A]=A}).catch(()=>{v[A]=A});p.push(Ce)}),await Promise.all(p),je(v),ye(be)}finally{ve(!1)}}});return()=>{R(),M()}}catch(r){console.error("Error fetching league data:",r),c("Failed to load league data")}finally{T(!1)}}},a=async()=>{if(i)try{const[r,o]=await Promise.all([ss(i),Zs()]);le(r),he(o);const d=$(),n=me(H(d,"leagueSeasons"),I("leagueId","==",i),I("status","==","active"),ra(1)),z=await Te(n);if(!z.empty){const P=z.docs[0].data().seasonId,M=o.find(F=>F.id===P);M&&(pe(M),Y(P))}}catch(r){console.error("Error fetching seasons data:",r)}};s(),a()},[i]);const gs=async s=>{if(s.preventDefault(),!!i){x(!0),c(null);try{const a=$(),r={name:t.name,description:t.description,status:t.status,isPublic:t.isPublic,...X&&{photoURL:X},settings:{gameMode:t.gameMode,pointsToWin:t.pointsToWin,maxPlayers:t.maxPlayers,allowJoinRequests:t.allowJoinRequests,requireConfirmation:t.requireConfirmation,tournamentFormat:t.tournamentFormat,numberOfRounds:t.numberOfRounds,playoffsEnabled:t.playoffsEnabled,playoffTeams:t.playoffTeams,timeLimit:t.timeLimit,penaltiesEnabled:t.penaltiesEnabled,scoringSystem:{pointsPerWin:t.pointsPerWin,pointsPerDraw:t.pointsPerDraw,pointsPerLoss:t.pointsPerLoss,usePointDifferential:t.usePointDifferential}},updatedAt:K()};if(await fe(q(a,"leagues",i),r),k){const o={...k,name:t.name,description:t.description,status:t.status,isPublic:t.isPublic,settings:{...k.settings,gameMode:t.gameMode,pointsToWin:t.pointsToWin,maxPlayers:t.maxPlayers,allowJoinRequests:t.allowJoinRequests,requireConfirmation:t.requireConfirmation,tournamentFormat:t.tournamentFormat,numberOfRounds:t.numberOfRounds,playoffsEnabled:t.playoffsEnabled,playoffTeams:t.playoffTeams,timeLimit:t.timeLimit,penaltiesEnabled:t.penaltiesEnabled,scoringSystem:{pointsPerWin:t.pointsPerWin,pointsPerDraw:t.pointsPerDraw,pointsPerLoss:t.pointsPerLoss,usePointDifferential:t.usePointDifferential}}};re(o)}}catch(a){console.error("Error updating league:",a),c("Failed to update league settings")}finally{x(!1)}}},Qe=s=>{const{name:a,value:r}=s.target;h(o=>({...o,[a]:r}))},_=s=>{const{name:a,value:r}=s.target;h(o=>({...o,[a]:parseInt(r)||0}))},bs=async s=>{if(!i)throw new Error("League ID not found");ge(null);try{const a=await ea(s,i);return xe(a),a}catch(a){const r=a instanceof Error?a.message:"Failed to upload image";throw ge(r),a}},fs=()=>{xe(null),ge(null)},Ae=async s=>{try{const a=await Xs(s.userId);a&&os(a)}catch(a){console.error("Error fetching user profile:",a)}},qe=async(s,a)=>{if(!(!i||!s)){x(!0),c(null);try{const r=$(),o=q(r,"leagueMemberships",s);await fe(o,{status:a,updatedAt:K()}),D(d=>d.map(n=>n.id===s?{...n,status:a}:n))}catch(r){console.error("Error updating member status:",r),c("Failed to update member status. Please try again.")}finally{x(!1)}}},He=async(s,a)=>{if(!(!i||!s)){if(a==="remove"){const r=w.find(o=>o.id===s);if(r){const o=C[r.userId]||r.userId;oe({id:s,name:o}),Z(!0)}return}x(!0),c(null);try{const r=$(),o=q(r,"leagueMemberships",s);a==="promote"?(await fe(o,{role:"admin",updatedAt:K()}),D(d=>d.map(n=>n.id===s?{...n,role:"admin"}:n))):a==="demote"&&(await fe(o,{role:"player",updatedAt:K()}),D(d=>d.map(n=>n.id===s?{...n,role:"player"}:n)))}catch(r){console.error(`Error ${a} member:`,r),c(`Failed to ${a} member. Please try again.`)}finally{x(!1)}}},ps=async()=>{if(ie){x(!0),c(null);try{const s=$(),a=q(s,"leagueMemberships",ie.id);await rs(a),D(r=>r.filter(o=>o.id!==ie.id)),Z(!1),oe(null)}catch(s){console.error("Error removing member:",s),c("Failed to remove member. Please try again.")}finally{x(!1)}}},Ke=async s=>{if(!(!i||!s)){x(!0),c(null);try{const a=$(),r=me(H(a,"leagueSeasons"),I("leagueId","==",i),I("seasonId","==",s));(await Te(r)).empty&&await na(H(a,"leagueSeasons"),{leagueId:i,seasonId:s,joinedAt:K(),status:"active"}),Y(s);const[d,n]=await Promise.all([ss(i),sa(i)]);le(d),pe(n)}catch(a){console.error("Error associating season with league:",a),c("Failed to associate season with league")}finally{x(!1)}}},js=async s=>{try{const a=$(),r=me(H(a,"leagueMemberships"),I("leagueId","==",s)),o=await Te(r),d=new Map;o.forEach(z=>{const R={id:z.id,...z.data()},P=R.userId;d.has(P)||d.set(P,[]),d.get(P).push(R)});let n=0;for(const[z,R]of d)if(R.length>1){R.sort((M,F)=>{if(M.status==="active"&&F.status!=="active")return-1;if(F.status==="active"&&M.status!=="active")return 1;const J=M.joinedAt?.toMillis()||0,Q=F.joinedAt?.toMillis()||0;return J!==Q?Q-J:M.id.localeCompare(F.id)});const P=R.slice(1);for(const M of P)try{await rs(q(a,"leagueMemberships",M.id)),n++}catch(F){console.error(`Failed to delete duplicate membership ${M.id}:`,F)}}return n>0&&console.log(`Cleaned ${n} duplicate memberships for league ${s}`),n}catch(a){return console.error("Error cleaning duplicates:",a),0}},Ve=l.useMemo(()=>[{accessorKey:"displayName",header:"Member",cell:({row:s})=>{const a=s.original,r=C[a.userId]||a.userId;return e.jsxs("div",{className:"font-medium text-xs sm:text-sm flex items-center space-x-2",children:[e.jsxs(As,{className:"h-6 w-6 sm:h-8 sm:w-8 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>Ae(a),children:[e.jsx(qs,{src:de[a.userId]||void 0,alt:r}),e.jsx(Is,{className:"text-xs",children:r.substring(0,2).toUpperCase()})]}),e.jsx("div",{className:"truncate max-w-20 sm:max-w-none cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors",title:r,onClick:()=>Ae(a),children:r})]})}},{accessorKey:"status",header:"Status",cell:({row:s})=>{const a=s.original;return e.jsxs(se,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(O,{variant:"ghost",size:"sm",onClick:r=>r.stopPropagation(),className:`px-2 py-1 text-xs rounded-full border ${a.status==="active"?"bg-green-100 text-green-800 border-green-200 hover:bg-green-200 dark:bg-green-900/20 dark:text-green-200 dark:border-green-800 dark:hover:bg-green-800/30":"bg-gray-100 text-gray-800 border-gray-200 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"}`,disabled:S,children:[a.status,e.jsx("span",{className:"ml-1",children:"▼"})]})}),e.jsxs(te,{children:[e.jsx(N,{onClick:()=>qe(a.id,"active"),className:a.status==="active"?"bg-green-50 dark:bg-green-900/20":"",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"Active"]})}),e.jsx(N,{onClick:()=>qe(a.id,"inactive"),className:a.status==="inactive"?"bg-gray-50 dark:bg-gray-800/50":"",children:e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-gray-500 rounded-full mr-2"}),"Inactive"]})})]})]})}},{accessorKey:"joinedAt",header:"Joined",cell:({row:s})=>{const a=s.original;return e.jsx("div",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400",children:a.joinedAt?new Date(a.joinedAt.toDate()).toLocaleDateString():"Unknown"})}},{id:"actions",header:"Actions",cell:({row:s})=>{const a=s.original;return a.role!=="owner"?e.jsx("div",{className:"text-right",children:e.jsx(O,{variant:"ghost",size:"sm",onClick:r=>{r.stopPropagation(),He(a.id,"remove")},disabled:S,className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 h-8 px-2 text-xs",children:"Remove"})}):null}}],[C,de,S,Ae,qe,He]),ys=l.useMemo(()=>w.map(s=>({...s,displayName:C[s.userId]||s.userId})),[w,C]),we=zs({data:ys,columns:Ve,onSortingChange:ms,onColumnFiltersChange:hs,onGlobalFilterChange:Ge,getCoreRowModel:Js(),getSortedRowModel:Ws(),getFilteredRowModel:$s(),globalFilterFn:"includesString",state:{sorting:cs,columnFilters:us,globalFilter:Oe}});return L?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):k?e.jsxs("div",{className:"p-3 sm:p-6 w-full max-w-full sm:max-w-6xl mx-auto dark:text-white",children:[e.jsx(ns,{isOpen:G,onClose:()=>B(!1),onConfirm:xs,title:"Delete League Completely",message:e.jsxs("div",{children:[e.jsxs("p",{className:"mb-2",children:["Are you sure you want to ",e.jsx("strong",{children:"permanently delete"})," the league"," ",e.jsx("strong",{children:k.name}),"?"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"font-medium text-red-600 dark:text-red-400 mb-2",children:"This action cannot be undone and will permanently delete ALL of the following:"}),e.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-1 ml-4",children:[e.jsx("li",{children:"• League profile and image from Firebase Storage"}),e.jsx("li",{children:"• All league memberships and member data"}),e.jsx("li",{children:"• All pending join requests"}),e.jsx("li",{children:"• All league-specific games and match history"}),e.jsx("li",{children:"• All league-season associations"}),e.jsx("li",{children:"• All league tournaments and standings"}),e.jsx("li",{children:"• All league teams (if any)"}),e.jsx("li",{children:"• All league invitations"})]})]}),e.jsx("p",{className:"text-sm font-medium text-orange-600 dark:text-orange-400",children:"Members will not lose their global stats, but all league-specific data will be lost forever."})]}),confirmText:"Delete League Permanently",isDestructive:!0}),e.jsx(ns,{isOpen:Je,onClose:()=>{Z(!1),oe(null)},onConfirm:ps,title:"Remove Member",message:e.jsxs("div",{children:[e.jsxs("p",{className:"mb-2",children:["Are you sure you want to permanently remove"," ",e.jsx("strong",{children:ie?.name})," from the league?"]}),e.jsx("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:"This action permanently deletes their membership from the database. They will need to request to join again if they want to rejoin."}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:'Note: Use "Inactive" status instead if you want to temporarily suspend them while keeping their membership record.'})]}),confirmText:"Remove Member",isDestructive:!0}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center",children:[e.jsx(Os,{className:"h-8 w-8 mr-2 text-blue-500"}),"Manage League: ",k.name]}),e.jsx(as,{to:`/leagues/${i}`,className:"text-blue-600 hover:underline whitespace-nowrap",children:"← Back to League"})]}),e.jsxs(Gs,{defaultValue:"details",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-3 sm:mx-0",children:e.jsxs(Bs,{className:"grid w-max min-w-full sm:w-full grid-cols-4 mx-3 sm:mx-0",children:[e.jsx(Pe,{value:"details",className:"text-xs sm:text-sm",children:"League Details"}),e.jsxs(Pe,{value:"members",className:"text-xs sm:text-sm",children:["Members (",w.filter(s=>s.status==="active").length,")"]}),e.jsxs(Pe,{value:"requests",className:"text-xs sm:text-sm",children:["Join Requests (",m.length,")"]}),e.jsx(Pe,{value:"danger",className:"text-xs sm:text-sm text-red-600 dark:text-red-400",children:"Danger Zone"})]})}),e.jsx(De,{value:"danger",className:"mt-4 sm:mt-6 w-full",children:e.jsxs(Se,{className:"w-full",children:[e.jsx(Re,{children:e.jsx(Me,{className:"text-red-600",children:"Danger Zone"})}),e.jsxs(Fe,{children:[g&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4 dark:bg-red-900/20",children:e.jsx("p",{className:"text-red-700 dark:text-red-300",children:g})}),e.jsxs("div",{className:"border border-red-300 rounded-md p-6 bg-red-50 dark:bg-red-900/10 dark:border-red-800",children:[e.jsx("h3",{className:"text-lg font-medium text-red-800 dark:text-red-400",children:"Delete League Completely"}),e.jsxs("div",{className:"text-sm text-red-700 dark:text-red-300 mt-1 mb-4",children:[e.jsxs("p",{className:"mb-3",children:["Once you delete a league, there is ",e.jsx("strong",{children:"no going back"}),". This will permanently remove ALL league data from Firebase, including:"]}),e.jsxs("ul",{className:"ml-4 space-y-1 mb-3",children:[e.jsx("li",{children:"• League profile and images from Firebase Storage"}),e.jsx("li",{children:"• All memberships and member data"}),e.jsx("li",{children:"• All games, matches, and tournament history"}),e.jsx("li",{children:"• All join requests and invitations"}),e.jsx("li",{children:"• All season associations"}),e.jsx("li",{children:"• All teams and standings"})]}),e.jsx("p",{className:"font-medium",children:"This comprehensive deletion will free up Firebase storage space and ensure no orphaned data remains."})]}),e.jsx("button",{onClick:()=>B(!0),disabled:S,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:S?"Deleting Everything...":"Delete League Permanently"})]})]})]})}),e.jsx(De,{value:"details",className:"mt-4 sm:mt-6 w-full",children:e.jsxs(Se,{className:"w-full",children:[e.jsx(Re,{children:e.jsx(Me,{children:"Edit League Details"})}),e.jsx(Fe,{children:e.jsxs("form",{onSubmit:gs,className:"space-y-6",children:[g&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4 dark:bg-red-900/20",children:e.jsx("p",{className:"text-red-700 dark:text-red-300",children:g})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white border-b pb-2",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"name",className:"text-sm font-medium",children:"League Name*"}),e.jsx("input",{type:"text",id:"name",name:"name",value:t.name,onChange:Qe,className:"w-full p-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600",required:!0})]}),e.jsxs("div",{children:[e.jsx(u,{className:"text-sm font-medium",children:"League Avatar"}),e.jsx("div",{className:"mt-1",children:e.jsx(ha,{currentImageUrl:X,onImageUpload:bs,onImageRemove:fs,uploading:b,error:ke,size:"md",title:"League Avatar",placeholder:"Upload",acceptedFormats:["JPG","PNG","GIF","WebP"],maxSizeInMB:5})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"status",className:"text-sm font-medium",children:"League Status"}),e.jsxs(se,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-full justify-between mt-1",children:[t.status||"Select status",e.jsx("span",{className:"ml-2",children:"▼"})]})}),e.jsxs(te,{className:"w-full",children:[e.jsx(N,{onClick:()=>h(s=>({...s,status:"upcoming"})),children:"Upcoming"}),e.jsx(N,{onClick:()=>h(s=>({...s,status:"active"})),children:"Active"}),e.jsx(N,{onClick:()=>h(s=>({...s,status:"completed"})),children:"Completed"}),e.jsx(N,{onClick:()=>h(s=>({...s,status:"canceled"})),children:"Canceled"})]})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"season",className:"text-sm font-medium",children:"Associated Season"}),e.jsxs(se,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-full justify-between mt-1",disabled:S,children:[W?E.find(s=>s.id===W)?.name||"Season not found":"Select a season",e.jsx("span",{className:"ml-2",children:"▼"})]})}),e.jsxs(te,{className:"w-full max-h-60 overflow-y-auto",children:[e.jsx(N,{onClick:()=>Ke(""),children:e.jsx("span",{className:"text-gray-500",children:"No season"})}),E.map(s=>e.jsx(N,{onClick:()=>Ke(s.id),className:W===s.id?"bg-blue-50 dark:bg-blue-900/20":"",children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s.status==="active"?"Active":s.status==="completed"?"Completed":"Upcoming",s.startDate&&` • ${new Date(s.startDate.toDate()).getFullYear()}`]})]})},s.id))]})]}),W&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"This league is associated with the selected global season"})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:t.description,onChange:Qe,className:"w-full p-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600",rows:3})]}),e.jsxs(u,{className:"hover:bg-accent/50 flex items-start gap-3 rounded-lg border p-3 has-[[aria-checked=true]]:border-blue-600 has-[[aria-checked=true]]:bg-blue-50 dark:has-[[aria-checked=true]]:border-blue-900 dark:has-[[aria-checked=true]]:bg-blue-950",children:[e.jsx(ue,{id:"isPublic",checked:t.isPublic,onCheckedChange:s=>h(a=>({...a,isPublic:!!s})),className:"data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600 data-[state=checked]:text-white dark:data-[state=checked]:border-blue-700 dark:data-[state=checked]:bg-blue-700"}),e.jsxs("div",{className:"grid gap-1.5 font-normal",children:[e.jsx("p",{className:"text-sm leading-none font-medium",children:"Public League"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"When enabled, this league appears in the public leagues list and anyone can request to join. When disabled, the league is private and only visible to existing members and administrators."})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white border-b pb-2",children:"Game Settings"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"gameMode",className:"text-sm font-medium",children:"Game Mode"}),e.jsxs(se,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-full justify-between mt-1",disabled:Ne,children:[ce?.gameModes.find(s=>s.value===t.gameMode)?.label||"Select game mode",e.jsx("span",{className:"ml-2",children:"▼"})]})}),e.jsx(te,{className:"w-full",children:ce?.gameModes.map(s=>e.jsx(N,{onClick:()=>h(a=>({...a,gameMode:s.value})),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.label}),s.description&&e.jsx("span",{className:"text-xs text-gray-500",children:s.description})]})},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"pointsToWin",className:"text-sm font-medium",children:"Points to Win"}),e.jsxs(se,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-full justify-between mt-1",disabled:Ne,children:[ce?.pointsOptions.find(s=>s.value===t.pointsToWin)?.label||`${t.pointsToWin} points`,e.jsx("span",{className:"ml-2",children:"▼"})]})}),e.jsx(te,{className:"w-full",children:ce?.pointsOptions.map(s=>e.jsx(N,{onClick:()=>h(a=>({...a,pointsToWin:s.value})),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.label}),s.description&&e.jsx("span",{className:"text-xs text-gray-500",children:s.description})]})},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"ruleset",className:"text-sm font-medium",children:"Ruleset"}),e.jsxs(se,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-full justify-between mt-1",disabled:Ne,children:[ce?.rulesets.find(s=>s.value===t.ruleset)?.label||"Select ruleset",e.jsx("span",{className:"ml-2",children:"▼"})]})}),e.jsx(te,{className:"w-full",children:ce?.rulesets.map(s=>e.jsx(N,{onClick:()=>h(a=>({...a,ruleset:s.value})),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.label}),s.description&&e.jsx("span",{className:"text-xs text-gray-500",children:s.description})]})},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"maxPlayers",className:"text-sm font-medium",children:"Maximum Players"}),e.jsx("input",{type:"number",id:"maxPlayers",name:"maxPlayers",value:t.maxPlayers,onChange:_,min:t.gameMode==="double"?"4":"2",max:"64",step:t.gameMode==="double"?"4":"1",className:"w-full p-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t.gameMode==="double"?"Must be divisible by 4 for team play":"Minimum 2 players"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"timeLimit",className:"text-sm font-medium",children:"Time Limit (minutes)"}),e.jsx("input",{type:"number",id:"timeLimit",name:"timeLimit",value:t.timeLimit,onChange:_,min:"0",max:"120",className:"w-full p-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Set to 0 for no time limit"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(u,{className:"hover:bg-accent/50 flex items-start gap-3 rounded-lg border p-3 has-[[aria-checked=true]]:border-blue-600 has-[[aria-checked=true]]:bg-blue-50 dark:has-[[aria-checked=true]]:border-blue-900 dark:has-[[aria-checked=true]]:bg-blue-950",children:[e.jsx(ue,{id:"allowJoinRequests",checked:t.allowJoinRequests,onCheckedChange:s=>h(a=>({...a,allowJoinRequests:!!s})),className:"data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600 data-[state=checked]:text-white dark:data-[state=checked]:border-blue-700 dark:data-[state=checked]:bg-blue-700"}),e.jsxs("div",{className:"grid gap-1.5 font-normal",children:[e.jsx("p",{className:"text-sm leading-none font-medium",children:"Allow Join Requests"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Players can request to join this league"})]})]}),e.jsxs(u,{className:"hover:bg-accent/50 flex items-start gap-3 rounded-lg border p-3 has-[[aria-checked=true]]:border-blue-600 has-[[aria-checked=true]]:bg-blue-50 dark:has-[[aria-checked=true]]:border-blue-900 dark:has-[[aria-checked=true]]:bg-blue-950",children:[e.jsx(ue,{id:"requireConfirmation",checked:t.requireConfirmation,onCheckedChange:s=>h(a=>({...a,requireConfirmation:!!s})),className:"data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600 data-[state=checked]:text-white dark:data-[state=checked]:border-blue-700 dark:data-[state=checked]:bg-blue-700"}),e.jsxs("div",{className:"grid gap-1.5 font-normal",children:[e.jsx("p",{className:"text-sm leading-none font-medium",children:"Require Game Confirmation"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Both players must confirm game results"})]})]}),e.jsxs(u,{className:"hover:bg-accent/50 flex items-start gap-3 rounded-lg border p-3 has-[[aria-checked=true]]:border-blue-600 has-[[aria-checked=true]]:bg-blue-50 dark:has-[[aria-checked=true]]:border-blue-900 dark:has-[[aria-checked=true]]:bg-blue-950",children:[e.jsx(ue,{id:"penaltiesEnabled",checked:t.penaltiesEnabled,onCheckedChange:s=>h(a=>({...a,penaltiesEnabled:!!s})),className:"data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600 data-[state=checked]:text-white dark:data-[state=checked]:border-blue-700 dark:data-[state=checked]:bg-blue-700"}),e.jsxs("div",{className:"grid gap-1.5 font-normal",children:[e.jsx("p",{className:"text-sm leading-none font-medium",children:"Enable Penalties"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Allow penalty points for rule violations"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white border-b pb-2",children:"Tournament Settings"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"tournamentFormat",className:"text-sm font-medium",children:"Tournament Format"}),e.jsxs(se,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"w-full justify-between mt-1",children:[t.tournamentFormat==="round-robin"?"Round Robin":t.tournamentFormat==="elimination"?"Elimination":t.tournamentFormat==="swiss"?"Swiss":"Custom",e.jsx("span",{className:"ml-2",children:"▼"})]})}),e.jsxs(te,{className:"w-full",children:[e.jsx(N,{onClick:()=>h(s=>({...s,tournamentFormat:"round-robin"})),children:"Round Robin"}),e.jsx(N,{onClick:()=>h(s=>({...s,tournamentFormat:"elimination"})),children:"Elimination"}),e.jsx(N,{onClick:()=>h(s=>({...s,tournamentFormat:"swiss"})),children:"Swiss"}),e.jsx(N,{onClick:()=>h(s=>({...s,tournamentFormat:"custom"})),children:"Custom"})]})]})]}),t.tournamentFormat!=="elimination"&&e.jsxs("div",{children:[e.jsx(u,{htmlFor:"numberOfRounds",className:"text-sm font-medium",children:"Number of Rounds"}),e.jsx("input",{type:"number",id:"numberOfRounds",name:"numberOfRounds",value:t.numberOfRounds,onChange:_,min:"1",max:"20",className:"w-full p-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600"})]})]}),e.jsxs(u,{className:"hover:bg-accent/50 flex items-start gap-3 rounded-lg border p-3 has-[[aria-checked=true]]:border-blue-600 has-[[aria-checked=true]]:bg-blue-50 dark:has-[[aria-checked=true]]:border-blue-900 dark:has-[[aria-checked=true]]:bg-blue-950",children:[e.jsx(ue,{id:"playoffsEnabled",checked:t.playoffsEnabled,onCheckedChange:s=>h(a=>({...a,playoffsEnabled:!!s})),className:"data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600 data-[state=checked]:text-white dark:data-[state=checked]:border-blue-700 dark:data-[state=checked]:bg-blue-700"}),e.jsxs("div",{className:"grid gap-1.5 font-normal",children:[e.jsx("p",{className:"text-sm leading-none font-medium",children:"Enable Playoffs"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Top teams advance to playoff rounds"})]})]}),t.playoffsEnabled&&e.jsxs("div",{children:[e.jsx(u,{htmlFor:"playoffTeams",className:"text-sm font-medium",children:"Teams in Playoffs"}),e.jsx("input",{type:"number",id:"playoffTeams",name:"playoffTeams",value:t.playoffTeams,onChange:_,min:"2",max:"16",className:"w-full p-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Number of teams that qualify for playoffs"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white border-b pb-2",children:"League Scoring System"}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-md",children:e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"These are league points awarded for tournament standings, not domino game points."})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"pointsPerWin",className:"text-sm font-medium",children:"Points per Win"}),e.jsx("input",{type:"number",id:"pointsPerWin",name:"pointsPerWin",value:t.pointsPerWin,onChange:_,min:"0",max:"10",className:"w-full p-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"pointsPerDraw",className:"text-sm font-medium",children:"Points per Draw"}),e.jsx("input",{type:"number",id:"pointsPerDraw",name:"pointsPerDraw",value:t.pointsPerDraw,onChange:_,min:"0",max:"5",className:"w-full p-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"pointsPerLoss",className:"text-sm font-medium",children:"Points per Loss"}),e.jsx("input",{type:"number",id:"pointsPerLoss",name:"pointsPerLoss",value:t.pointsPerLoss,onChange:_,min:"0",max:"2",className:"w-full p-2 mt-1 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600"})]})]}),e.jsxs(u,{className:"hover:bg-accent/50 flex items-start gap-3 rounded-lg border p-3 has-[[aria-checked=true]]:border-blue-600 has-[[aria-checked=true]]:bg-blue-50 dark:has-[[aria-checked=true]]:border-blue-900 dark:has-[[aria-checked=true]]:bg-blue-950",children:[e.jsx(ue,{id:"usePointDifferential",checked:t.usePointDifferential,onCheckedChange:s=>h(a=>({...a,usePointDifferential:!!s})),className:"data-[state=checked]:border-blue-600 data-[state=checked]:bg-blue-600 data-[state=checked]:text-white dark:data-[state=checked]:border-blue-700 dark:data-[state=checked]:bg-blue-700"}),e.jsxs("div",{className:"grid gap-1.5 font-normal",children:[e.jsx("p",{className:"text-sm leading-none font-medium",children:"Use Point Differential for Tiebreaker"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Consider the difference in game points when ranking teams"})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(O,{type:"submit",disabled:S||Ne,className:"w-full sm:w-auto",children:S?"Saving...":"Save Changes"})})]})})]})}),e.jsx(De,{value:"members",className:"mt-4 sm:mt-6 w-full",children:e.jsxs(Se,{className:"w-full",children:[e.jsx(Re,{children:e.jsxs(Me,{children:["League Members (",w.filter(s=>s.status==="active").length," active, ",w.length," total)"]})}),e.jsxs(Fe,{children:[g&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4 dark:bg-red-900/20",children:e.jsx("p",{className:"text-red-700 dark:text-red-300",children:g})}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-md mb-4",children:[e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Status Info:"})," Active members can play games and appear in rankings. Inactive members remain in the league but cannot play games or appear in rankings."]}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:[e.jsx("strong",{children:"Important:"})," Points earned by other players from games against inactive/removed members are preserved. The ranking system includes all historical games for accurate statistics."]}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:'Note: Inactive status should be used for temporary suspensions or breaks. Use "Remove" for permanent removal.'})]}),w.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No members in this league yet"}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(ga,{placeholder:"Search members...",value:Oe??"",onChange:s=>Ge(String(s.target.value)),className:"max-w-sm"}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-2",children:[we.getRowModel().rows.length," of ",w.length," members"]})]}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs(Qs,{children:[e.jsx(Hs,{children:we.getHeaderGroups().map(s=>e.jsx($e,{children:s.headers.map(a=>e.jsx(Ks,{children:a.isPlaceholder?null:Xe(a.column.columnDef.header,a.getContext())},a.id))},s.id))}),e.jsx(Vs,{children:we.getRowModel().rows?.length?we.getRowModel().rows.map(s=>e.jsx($e,{"data-state":s.getIsSelected()&&"selected",className:"hover:bg-gray-50 dark:hover:bg-zinc-700/50",children:s.getVisibleCells().map(a=>e.jsx(_e,{children:Xe(a.column.columnDef.cell,a.getContext())},a.id))},s.id)):e.jsx($e,{children:e.jsx(_e,{colSpan:Ve.length,className:"h-24 text-center",children:"No members found."})})})]})})]})]})]})}),e.jsx(De,{value:"requests",className:"mt-4 sm:mt-6 w-full",children:e.jsxs(Se,{className:"w-full",children:[e.jsx(Re,{children:e.jsxs(Me,{children:["Join Requests (",m.length,")"]})}),e.jsxs(Fe,{children:[g&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4 dark:bg-red-900/20",children:e.jsx("p",{className:"text-red-700 dark:text-red-300",children:g})}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-md mb-4",children:e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"About Join Requests:"})," Players can request to join this league if it's public and allows join requests. You can approve or reject pending requests from this section."]})}),m.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No pending join requests"}):e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsx("div",{className:"bg-gray-50 dark:bg-zinc-700 rounded-lg p-4 border border-gray-200 dark:border-zinc-600",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-medium",children:C[s.userId]||s.userId}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Requested"," ",new Date(s.requestedAt.toDate()).toLocaleDateString()]}),s.message&&e.jsx("p",{className:"mt-2 text-gray-700 dark:text-gray-300",children:s.message})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>Be(s.id,"approved"),className:"px-3 py-1 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 text-center",children:"Approve"}),e.jsx("button",{onClick:()=>Be(s.id,"rejected"),className:"px-3 py-1 bg-red-600 text-white text-sm rounded-md hover:bg-red-700 text-center",children:"Reject"})]})]})},s.id))})]})]})})]}),e.jsx(Ys,{isOpen:ls,onClose:ds,user:is})]}):e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[e.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-4",children:e.jsx("div",{className:"flex",children:e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-red-700",children:g||"League not found"})})})}),e.jsx(as,{to:"/leagues",className:"text-blue-600 hover:underline",children:"← Back to Leagues"})]})};export{Na as default};
