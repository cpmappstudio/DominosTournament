import{v as je,m as c,w as ye,i as F,x as Z,y as Ne,z as ve,A as ke,E as we,G as Pe,j as e,C as _,d as O,H as Ce,U as Se,I as Ue,J as Ie,K as ze}from"./index-CI_ALA14.js";import{r as l,g as Ge,d as Re,L as V}from"./router-DHx2Xk7F.js";import{c as Te,h as Ae,A as De}from"./firebase-C4-V31L8.js";import"./vendor-DJG_os-6.js";const ee=l.memo(({gameMode:o})=>{const i=Ue(o);return e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-zinc-700 rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Game Mode"}),e.jsxs("p",{className:"font-medium",children:[i?.label||o,!i?.isValid&&e.jsx("span",{className:"ml-2 text-xs text-red-500",children:"(Legacy)"})]}),i?.description&&e.jsx("p",{className:"text-xs text-gray-400 dark:text-zinc-500 mt-1",children:i.description})]})}),se=l.memo(({points:o})=>{const i=Ie(o);return e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-zinc-700 rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Points to Win"}),e.jsxs("p",{className:"font-medium",children:[i?.label||`${o} points`,!i?.isValid&&e.jsx("span",{className:"ml-2 text-xs text-red-500",children:"(Custom)"})]}),i?.description&&e.jsx("p",{className:"text-xs text-gray-400 dark:text-zinc-500 mt-1",children:i.description})]})}),te=l.memo(({useBoricuaRules:o})=>{const w=ze(o?"boricua":"standard");return e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-zinc-700 rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Game Rules"}),e.jsxs("p",{className:"font-medium",children:[w?.label||(o?"Boricua":"Standard"),!w?.isValid&&e.jsx("span",{className:"ml-2 text-xs text-red-500",children:"(Legacy)"})]}),w?.description&&e.jsx("p",{className:"text-xs text-gray-400 dark:text-zinc-500 mt-1",children:w.description})]})});ee.displayName="GameModeDisplay";se.displayName="PointsDisplay";te.displayName="RulesetDisplay";const Le=({refreshNotifications:o})=>{const{id:i}=Ge(),w=Re(),[ae,n]=l.useState({game:null,creator:null,opponent:null,team1Players:[],team2Players:[],leagueInfo:null,loading:!0,error:null}),[re,b]=l.useState({creatorScore:0,opponentScore:0,isSubmitting:!1}),[ne,le]=l.useState({rejectionReason:""}),{isOpen:ie,selectedUser:f,openModal:Y,closeModal:oe}=je(),{game:s,creator:x,opponent:u,team1Players:j,team2Players:P,leagueInfo:S,loading:de,error:M}=ae,{creatorScore:N,opponentScore:v,isSubmitting:m}=re,{rejectionReason:W}=ne,B=l.useCallback(()=>s?.activePlayer?s.teams?[...j,...P].find(r=>r.uid===s.activePlayer)?.displayName||"Unknown":s.activePlayer===s.createdBy?x?.displayName||"Creator":u?.displayName||"Opponent":"Unknown",[s,x,u,j,P]),ce=l.useCallback(()=>s?.teams?(j.some(r=>r.uid===c.currentUser?.uid)?P:j).map(r=>r.displayName).join(" and "):u?.displayName||"the opponent",[s,u,j,P]),U=l.useCallback(()=>{if(s?.teams){const a=j.map(r=>r.displayName).join(" + "),t=P.map(r=>r.displayName).join(" + ");return{team1:a,team2:t}}else return{team1:x?.displayName||"Creator",team2:u?.displayName||"Opponent"}},[s,x,u,j,P]),z=l.useCallback(()=>!s||!c.currentUser?!1:s.createdBy===c.currentUser.uid||s.opponent===c.currentUser.uid?!0:s.teams?[...s.teams.team1||[],...s.teams.team2||[]].includes(c.currentUser.uid):!1,[s]),G=l.useCallback(()=>!s||!c.currentUser?!1:s.createdBy===c.currentUser.uid?!0:s.teams&&s.teams.team1&&s.teams.team1.length>0?s.teams.team1[0]===c.currentUser.uid:!1,[s]),q=l.useCallback(()=>!s||!c.currentUser?!1:s.opponent===c.currentUser.uid?!0:s.teams&&s.teams.team2&&s.teams.team2.length>0?s.teams.team2[0]===c.currentUser.uid:!1,[s]),R=l.useCallback(()=>!s||!c.currentUser?!1:s.status==="in_progress"&&s.activePlayer?s.activePlayer===c.currentUser.uid:G(),[s,G]),I=l.useCallback(()=>!s||!c.currentUser?!1:s.status==="invited"&&s.opponent===c.currentUser.uid,[s]),H=l.useCallback(()=>!s||!c.currentUser?!1:s.status==="invited"&&s.createdBy===c.currentUser.uid,[s]),T=l.useCallback(()=>s?s.status==="accepted":!1,[s]),J=l.useCallback(()=>!s||!c.currentUser||!s.activePlayer?!1:s.activePlayer===c.currentUser.uid,[s]),A=l.useCallback(()=>!s||!c.currentUser?!1:s.status==="waiting_confirmation"&&s.confirmedBy===c.currentUser.uid,[s]),K=l.useCallback(async a=>{try{n(d=>({...d,loading:!0,error:null}));const t=await ye(a);if(!t){n(d=>({...d,loading:!1,error:"Game not found"}));return}if(t.teams&&t.teams.team1&&t.teams.team2){const g=[...t.teams.team1,...t.teams.team2].map(h=>F(h)),y=t.leagueId?Z(t.leagueId):Promise.resolve(null),[k,L]=await Promise.allSettled([Promise.allSettled(g),y]),C=k.status==="fulfilled"?k.value.map(h=>h.status==="fulfilled"?h.value:null).filter(h=>h!==null):[],E=C.filter(h=>t.teams.team1.includes(h.uid)),he=C.filter(h=>t.teams.team2.includes(h.uid)),$=L.status==="fulfilled"?L.value:null,fe=$?{id:$.id,name:$.name,photoURL:$.photoURL}:null;n({game:t,creator:null,opponent:null,team1Players:E,team2Players:he,leagueInfo:fe,loading:!1,error:null})}else{const[d,g,y]=await Promise.allSettled([F(t.createdBy),F(t.opponent),t.leagueId?Z(t.leagueId):Promise.resolve(null)]),k=d.status==="fulfilled"?d.value:null,L=g.status==="fulfilled"?g.value:null,C=y.status==="fulfilled"?y.value:null,E=C?{id:C.id,name:C.name,photoURL:C.photoURL}:null;n({game:t,creator:k,opponent:L,team1Players:[],team2Players:[],leagueInfo:E,loading:!1,error:null})}t.scores&&b(d=>({...d,creatorScore:t.scores?.creator||0,opponentScore:t.scores?.opponent||0}))}catch(t){console.error("Error loading game:",t),n(r=>({...r,loading:!1,error:"Failed to load game details"}))}},[]);l.useEffect(()=>{if(!i){n(g=>({...g,loading:!1,error:"Game ID is missing"}));return}K(i);const a=Te(),t=Ae(a,"games",i);let r;const d=De(t,g=>{if(g.exists()){const y={id:g.id,...g.data()};clearTimeout(r),r=setTimeout(()=>{n(k=>({...k,game:y})),y.scores&&b(k=>({...k,creatorScore:y.scores.creator,opponentScore:y.scores.opponent}))},100)}},g=>{console.error("Error listening to game updates:",g)});return()=>{d(),clearTimeout(r)}},[i,K]);const me=l.useCallback(async()=>{if(!i||!I()){n(a=>({...a,error:"You cannot accept this invitation"}));return}try{b(t=>({...t,isSubmitting:!0})),n(t=>({...t,error:null}));const a=await Ne(i);a?(n(t=>({...t,game:a})),o&&o()):n(t=>({...t,error:"Failed to accept invitation"}))}catch(a){console.error("Error accepting invitation:",a),n(t=>({...t,error:a.message||"An error occurred while accepting the invitation"}))}finally{b(a=>({...a,isSubmitting:!1}))}},[i,I,o]),ue=l.useCallback(async()=>{if(!i||!I()){n(a=>({...a,error:"You cannot reject this invitation"}));return}try{b(t=>({...t,isSubmitting:!0})),n(t=>({...t,error:null}));const a=await ve(i,W);a?(n(t=>({...t,game:a})),o&&o(),w("/games")):n(t=>({...t,error:"Failed to reject invitation"}))}catch(a){console.error("Error rejecting invitation:",a),n(t=>({...t,error:a.message||"An error occurred while rejecting the invitation"}))}finally{b(a=>({...a,isSubmitting:!1}))}},[i,I,W,o,w]),xe=l.useCallback(async()=>{if(!i||!T()){n(a=>({...a,error:"This game is not ready to start"}));return}try{b(t=>({...t,isSubmitting:!0})),n(t=>({...t,error:null}));const a=await ke(i);a?(n(t=>({...t,game:a})),o&&o()):n(t=>({...t,error:"Failed to start the game"}))}catch(a){console.error("Error starting game:",a),n(t=>({...t,error:a.message||"An error occurred while starting the game"}))}finally{b(a=>({...a,isSubmitting:!1}))}},[i,T,o]),be=l.useCallback(async a=>{if(a.preventDefault(),!i||!z()||!s){n(r=>({...r,error:"You cannot submit scores for this game"}));return}if(!R()){n(r=>({...r,error:"It's not your turn to submit scores"}));return}if(N<0||v<0){n(r=>({...r,error:"Scores cannot be negative"}));return}if(Math.max(N,v)<s.settings.pointsToWin){n(r=>({...r,error:`At least one player must reach ${s.settings.pointsToWin} points to end the game`}));return}try{b(d=>({...d,isSubmitting:!0})),n(d=>({...d,error:null}));const r=await we(i,N,v);r?(n(d=>({...d,game:r})),o&&o()):n(d=>({...d,error:"Failed to submit scores"}))}catch(r){console.error("Error submitting scores:",r),n(d=>({...d,error:r.message||"An error occurred while submitting scores"}))}finally{b(r=>({...r,isSubmitting:!1}))}},[i,z,s,R,N,v,o]),Q=l.useCallback(async a=>{if(!i||!A()||!s){n(t=>({...t,error:"You cannot confirm this game"}));return}try{b(r=>({...r,isSubmitting:!0})),n(r=>({...r,error:null}));const t=await Pe(i,a);t?(n(r=>({...r,game:t})),o&&o()):n(r=>({...r,error:a?"Failed to confirm game":"Failed to dispute game"}))}catch(t){console.error("Error confirming game:",t),n(r=>({...r,error:t.message||"An error occurred while confirming the game"}))}finally{b(t=>({...t,isSubmitting:!1}))}},[i,A,s,o]),p=l.useMemo(()=>s?{isParticipant:z(),isCreator:G(),isOpponent:q(),canSubmitScores:R(),isPendingInvitation:I(),isSentInvitation:H(),isAccepted:T(),isCurrentUserTurn:J(),needsConfirmation:A()}:null,[s,z,G,q,R,I,H,T,J,A]),X=l.useMemo(()=>{if(!s)return{isValid:!1,canSubmit:!1};const a=Math.max(N,v),t=N>=0&&v>=0,r=t&&a>=s.settings.pointsToWin;return{isValid:t,canSubmit:r,maxScore:a}},[s,N,v]),D=l.useCallback(a=>{Y(a)},[Y]),ge=l.useMemo(()=>e.jsxs("div",{className:"p-4 sm:p-6 max-w-sm sm:max-w-6xl mx-auto text-zinc-900 dark:text-white",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-6",children:"Game Details"}),e.jsx(_,{children:e.jsx(O,{className:"flex justify-center p-6",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})})]}),[]),pe=l.useMemo(()=>e.jsxs("div",{className:"p-4 sm:p-6 max-w-sm sm:max-w-6xl mx-auto text-zinc-900 dark:text-white",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-6",children:"Game Details"}),e.jsx(_,{children:e.jsxs(O,{className:"p-6",children:[e.jsx("div",{className:"p-4 bg-red-100 border border-red-400 text-red-700 rounded mb-4",children:M||"Game not found"}),e.jsx(V,{to:"/games",className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-md",children:"Back to Games"})]})})]}),[M]);return de?ge:M||!s?pe:e.jsxs("div",{className:"p-4 sm:p-6 max-w-sm sm:max-w-6xl mx-auto text-zinc-900 dark:text-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold",children:"Game Details"}),e.jsx(V,{to:"/games",className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 text-sm sm:text-base",children:"Back to Games"})]}),e.jsx(_,{children:e.jsxs(O,{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsxs("span",{className:`inline-block px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-medium 
            ${s.status==="invited"?"bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-100":""}
            ${s.status==="accepted"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100":""}
            ${s.status==="rejected"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100":""}
            ${s.status==="in_progress"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100":""}
            ${s.status==="waiting_confirmation"?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-100":""}
            ${s.status==="completed"?"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100":""}
          `,children:[s.status==="invited"&&"Invitation Pending",s.status==="accepted"&&"Ready to Play",s.status==="rejected"&&"Invitation Rejected",s.status==="in_progress"&&"In Progress",s.status==="waiting_confirmation"&&"Waiting for Confirmation",s.status==="completed"&&"Completed"]}),s.status==="in_progress"&&s.activePlayer&&e.jsxs("span",{className:"ml-2 sm:ml-3 text-xs sm:text-sm block sm:inline mt-2 sm:mt-0",children:["Current Turn: ",B()]})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsx(ee,{gameMode:s.settings.gameMode}),e.jsx(se,{points:s.settings.pointsToWin}),e.jsx(te,{useBoricuaRules:s.settings.useBoricuaRules||!1}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-zinc-700 rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Created"}),e.jsx("p",{className:"font-medium",children:s.createdAt?new Date(s.createdAt.toDate()).toLocaleString():"Unknown"})]}),S&&e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-900 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ce,{src:S.photoURL||void 0,initials:S.name.substring(0,2).toUpperCase(),alt:`${S.name} league`,className:"h-12 w-12 mr-3 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"League Game"}),e.jsx("p",{className:"font-medium text-blue-800 dark:text-blue-200 truncate",children:S.name}),e.jsx(V,{to:`/leagues/${S.id}`,className:"text-xs text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",children:"View League Details â†’"})]})]})})]}),e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold mb-3",children:s.teams?"Teams (2 vs 2)":"Participants"}),s.teams?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border border-blue-200 dark:border-blue-800 rounded-lg p-4 bg-blue-50 dark:bg-blue-900/10",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full mr-2"}),e.jsx("h3",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Team 1"})]}),e.jsx("div",{className:"space-y-3",children:j.map((a,t)=>e.jsxs("div",{className:"flex items-center p-2 rounded-md hover:bg-blue-100 dark:hover:bg-blue-800/20 transition-colors cursor-pointer",onClick:()=>D(a),children:[a.photoURL?e.jsx("img",{src:a.photoURL,alt:a.displayName,className:"w-8 h-8 rounded-full mr-2"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2 text-sm",children:a.displayName.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:a.displayName}),t===0&&e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Team Captain"}),a.stats&&e.jsxs("div",{className:"flex space-x-2 mt-1",children:[e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[a.stats.gamesWon,"W"]}),e.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:[a.stats.gamesPlayed,"GP"]})]})]})]},a.uid))})]}),e.jsxs("div",{className:"border border-red-200 dark:border-red-800 rounded-lg p-4 bg-red-50 dark:bg-red-900/10",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-2"}),e.jsx("h3",{className:"font-medium text-red-700 dark:text-red-300",children:"Team 2"})]}),e.jsx("div",{className:"space-y-3",children:P.map((a,t)=>e.jsxs("div",{className:"flex items-center p-2 rounded-md hover:bg-red-100 dark:hover:bg-red-800/20 transition-colors cursor-pointer",onClick:()=>D(a),children:[a.photoURL?e.jsx("img",{src:a.photoURL,alt:a.displayName,className:"w-8 h-8 rounded-full mr-2"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500 text-white flex items-center justify-center mr-2 text-sm",children:a.displayName.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:a.displayName}),t===0&&e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:"Team Captain"}),a.stats&&e.jsxs("div",{className:"flex space-x-2 mt-1",children:[e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[a.stats.gamesWon,"W"]}),e.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:[a.stats.gamesPlayed,"GP"]})]})]})]},a.uid))})]})]}):e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1 p-3 border border-gray-200 dark:border-zinc-700 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer",onClick:()=>x&&D(x),children:e.jsxs("div",{className:"flex items-center",children:[x?.photoURL?e.jsx("img",{src:x.photoURL,alt:x.displayName,className:"w-12 h-12 rounded-full mr-3"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:x?.displayName.charAt(0).toUpperCase()||"?"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:x?.displayName||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Creator"}),x?.stats&&e.jsxs("div",{className:"flex space-x-4 mt-1",children:[e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[x.stats.gamesWon," wins"]}),e.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:[x.stats.gamesPlayed," games"]})]})]})]})}),e.jsx("div",{className:"flex-1 p-3 border border-gray-200 dark:border-zinc-700 rounded-md hover:bg-gray-50 dark:hover:bg-zinc-800 transition-colors cursor-pointer",onClick:()=>u&&D(u),children:e.jsxs("div",{className:"flex items-center",children:[u?.photoURL?e.jsx("img",{src:u.photoURL,alt:u.displayName,className:"w-12 h-12 rounded-full mr-3"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 text-white flex items-center justify-center mr-3",children:u?.displayName.charAt(0).toUpperCase()||"?"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:u?.displayName||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-zinc-400",children:"Opponent"}),u?.stats&&e.jsxs("div",{className:"flex space-x-4 mt-1",children:[e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[u.stats.gamesWon," wins"]}),e.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:[u.stats.gamesPlayed," games"]})]})]})]})})]})]}),p?.isPendingInvitation&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Game Invitation"}),e.jsxs("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-900 rounded-md mb-4",children:[e.jsx("p",{className:"mb-3",children:s.teams?`${j[0]?.displayName||"A player"} has invited you to play a team game of dominoes (2 vs 2).`:`${x?.displayName||"A player"} has invited you to play a game of dominoes.`}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Rejection Reason (optional)"}),e.jsx("input",{type:"text",value:W,onChange:a=>le(t=>({...t,rejectionReason:a.target.value})),placeholder:"Reason for declining (optional)",className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx("button",{onClick:ue,disabled:m,className:`py-2 rounded-md font-medium ${m?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-zinc-700 dark:text-zinc-400":"bg-red-600 text-white hover:bg-red-700"}`,children:m?"Processing...":"Decline Invitation"}),e.jsx("button",{onClick:me,disabled:m,className:`py-2 rounded-md font-medium ${m?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-zinc-700 dark:text-zinc-400":"bg-green-600 text-white hover:bg-green-700"}`,children:m?"Processing...":"Accept Invitation"})]})]})]}),p?.isSentInvitation&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Invitation Sent"}),e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-900 rounded-md mb-4",children:e.jsxs("p",{children:["Your invitation has been sent to ",ce(),". You'll be notified when they accept or decline."]})})]}),p?.isAccepted&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Ready to Play"}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-900 rounded-md mb-4",children:[e.jsx("p",{className:"mb-3",children:"Both players have accepted! You're ready to start the game."}),e.jsx("button",{onClick:xe,disabled:m,className:`w-full py-2 rounded-md font-medium ${m?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-zinc-700 dark:text-zinc-400":"bg-blue-600 text-white hover:bg-blue-700"}`,children:m?"Starting Game...":"Start Game"})]})]}),s.status==="rejected"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Invitation Declined"}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-900 rounded-md mb-4",children:[e.jsx("p",{children:"This game invitation was declined."}),s.rejectionReason&&e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Reason:"})," ",s.rejectionReason]})]})]}),s.status==="in_progress"&&p?.isParticipant&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Submit Final Scores"}),p?.canSubmitScores?e.jsxs("form",{onSubmit:be,children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-900 rounded-md mb-4",children:[e.jsx("p",{children:"You are submitting the final scores for this game. The other player will need to confirm these scores."}),e.jsxs("p",{className:"mt-2 text-sm",children:["Enter scores for both players. At least one player must reach ",s.settings.pointsToWin," points."]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:U().team1}),e.jsx("input",{type:"number",min:"0",max:"999",value:N,onChange:a=>b(t=>({...t,creatorScore:parseInt(a.target.value)||0})),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:U().team2}),e.jsx("input",{type:"number",min:"0",max:"999",value:v,onChange:a=>b(t=>({...t,opponentScore:parseInt(a.target.value)||0})),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-zinc-700 dark:border-zinc-600",required:!0})]})]}),e.jsx("button",{type:"submit",disabled:m||!X.canSubmit,className:`w-full py-2 rounded-md font-medium ${m||!X.canSubmit?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-zinc-700 dark:text-zinc-400":"bg-blue-600 text-white hover:bg-blue-700"}`,children:m?"Submitting...":"Submit Final Scores"})]}):e.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-900 rounded-md mb-4",children:[e.jsx("p",{children:"It's not your turn to submit scores. Wait for the active player to finish their turn."}),e.jsxs("p",{className:"mt-2 text-sm",children:["Active player: ",e.jsx("span",{className:"font-medium",children:B()})]})]})]}),p?.needsConfirmation&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Confirm Results"}),e.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-900 rounded-md mb-4",children:[e.jsxs("p",{className:"mb-3",children:["The other ",s.teams?"team":"player"," has submitted the following scores:"]}),e.jsxs("div",{className:"flex justify-center items-center text-center mb-4",children:[e.jsxs("div",{className:"text-center px-6",children:[e.jsx("p",{className:"text-sm",children:U().team1}),e.jsx("p",{className:"text-2xl font-bold",children:s.scores?.creator||s.scores?.team1||0})]}),e.jsx("div",{className:"text-xl font-bold mx-4",children:"-"}),e.jsxs("div",{className:"text-center px-6",children:[e.jsx("p",{className:"text-sm",children:U().team2}),e.jsx("p",{className:"text-2xl font-bold",children:s.scores?.opponent||s.scores?.team2||0})]})]}),e.jsx("p",{className:"mb-3",children:"Are these scores correct?"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx("button",{onClick:()=>Q(!0),disabled:m,className:`py-2 rounded-md font-medium ${m?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-zinc-700 dark:text-zinc-400":"bg-green-600 text-white hover:bg-green-700"}`,children:m?"Processing...":"Confirm"}),e.jsx("button",{onClick:()=>Q(!1),disabled:m,className:`py-2 rounded-md font-medium ${m?"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-zinc-700 dark:text-zinc-400":"bg-red-600 text-white hover:bg-red-700"}`,children:m?"Processing...":"Dispute"})]})]})]}),s.status==="completed"&&s.scores&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Final Results"}),e.jsxs("div",{className:"p-4 rounded-md bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-900",children:[e.jsxs("div",{className:"flex justify-center items-center text-center mb-4",children:[e.jsxs("div",{className:"text-center px-6",children:[e.jsx("p",{className:"text-sm",children:U().team1}),e.jsx("p",{className:"text-3xl font-bold",children:s.scores.creator||s.scores.team1||0})]}),e.jsx("div",{className:"text-xl font-bold mx-4",children:"-"}),e.jsxs("div",{className:"text-center px-6",children:[e.jsx("p",{className:"text-sm",children:U().team2}),e.jsx("p",{className:"text-3xl font-bold",children:s.scores.opponent||s.scores.team2||0})]})]}),e.jsx("p",{className:"text-center font-medium",children:s.teams?"Team game completed":"Game completed"})]})]}),s.status==="waiting_confirmation"&&!p?.needsConfirmation&&e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-900 rounded-md mb-4",children:e.jsxs("p",{className:"text-center",children:["Waiting for ",p?.needsConfirmation?"you":"the other player"," to confirm the results."]})}),s.status==="in_progress"&&s.activePlayer&&e.jsxs("div",{className:`p-4 mb-4 rounded-md ${p?.isCurrentUserTurn?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-900":"bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-900"}`,children:[e.jsx("p",{className:"text-center font-medium",children:p?.isCurrentUserTurn?`It's your turn to play and submit the final scores${s.teams?" for your team":""}`:`Waiting for ${B()} to play and submit the final scores`}),p?.isCurrentUserTurn&&e.jsx("p",{className:"text-center text-sm mt-2 text-green-600 dark:text-green-400",children:"Play your game in person, then submit the final scores when finished"})]})]})}),e.jsx(Se,{user:f,isOpen:ie,onClose:oe,customStats:f?{gamesPlayed:f.stats.gamesPlayed,gamesWon:f.stats.gamesWon,totalPoints:f.stats.totalPoints,rank:f.stats.globalRank,winRate:f.stats.gamesPlayed>0?f.stats.gamesWon/f.stats.gamesPlayed*100:0}:void 0})]})},Ee=l.memo(Le);export{Ee as default};
